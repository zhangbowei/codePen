<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        * {
            box-sizing: border-box;
        }

        .container {
            width: 100px;
            position: relative;
        }

        .container input {
            width: 100%;
        }
    </style>
</head>

<body>
    <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
    <div class="container">
        <label for='name'>
            对应控制台中 modal.text变量:
        </label>
        <input name="name" bind="text" on="text">
    </div>
    <script>
        function bindViewToModal(domArr) {
            function getConf(dom, key) {
                const realKey = ['_', key].join('');
                return {
                    set(val) {
                        this[realKey] = val;
                        dom.value = val;
                    },
                    get(val) {
                        return this[realKey];
                    }
                };
            }

            return Array.from(domArr).reduce(function (stock, good) {
                const key = good.getAttribute('bind');
                Object.defineProperty(stock, key, getConf(good, key));
                return stock;
            }, {});
        }

        function dependModalOnView(domArr) {
            const modal = Array.from(domArr).reduce(function (stock, good) {
                stock[good.getAttribute('on')] = void 0;
                return stock;
            }, {});

            document.body.addEventListener('input', function (event) {
                const el = event.target;
                if (Array.from(domArr).includes(el)) {
                    const key = el.getAttribute('on');
                    modal[key] = el.value;
                }
            });

            return modal;
        }

        function mapModalAToB(modalA, modalB) {
            function getConf(modal, key) {
                return {
                    set(val) {
                        modal[key] = val;
                    },
                    get(val) {
                        return modal[key];
                    }
                };
            }

            Object.keys(modalA).forEach(function (key) {
                Object.defineProperty(modalA, key, getConf(modalB, key));
            });
        }

        const modalA = dependModalOnView(document.querySelectorAll('[on]'));
        const modalB = bindViewToModal(document.querySelectorAll('[bind]'));
        const modal = modalA;
        mapModalAToB(modalA, modalB);
    </script>
</body>

</html>